<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>qfly.crazyflie API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>qfly.crazyflie</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import math
from threading import Thread
import time
import traceback

from cflib.crazyflie.log import LogConfig
from cflib.crazyflie.syncLogger import SyncLogger

import cflib.crtp
from cflib.crazyflie import Crazyflie
from cflib.crazyflie.syncCrazyflie import SyncCrazyflie

import qfly
from qfly.utils import sqrt


class QualisysCrazyflie(Thread):
    &#34;&#34;&#34;
    Wrapper to track and fly a Bitcraze Crazyflie drone
    with Qualisys motion capture systems.
    &#34;&#34;&#34;

    def __init__(self,
                 cf_body_name,
                 cf_uri,
                 world,
                 marker_ids=[1, 2, 3, 4],
                 qtm_ip=&#34;127.0.0.1&#34;):
        &#34;&#34;&#34;
        Constructs a QualisysCrazyflie object.

        Parameters
        ----------
        cf_body_name : str
            Name of Crazyflie&#39;s rigid body in QTM.
        cf_uri : str
            Crazyflie radio address.
        world : World
            World object defining airspace rules.
        marker_ids : [int] (optional)
            ID numbers to be assigned to active markers
            in order of front, right, back, left.
        qtm_ip : str (optional)
            IP address of QTM host.
        &#34;&#34;&#34;

        print(f&#39;[{cf_body_name}@{cf_uri}] Initializing...&#39;)

        cflib.crtp.init_drivers()

        self.cf_body_name = cf_body_name
        self.cf_uri = cf_uri
        self.world = world
        self.marker_ids = marker_ids

        self.pose = None
        self.qtm = None
        self.qtm_ip = qtm_ip

        self.cf = Crazyflie(ro_cache=None, rw_cache=None)
        self.scf = SyncCrazyflie(self.cf_uri, cf=self.cf)

        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Connecting...&#39;)

    def __enter__(self):
        &#34;&#34;&#34;
        Enters QualisysCrazyflie context
        &#34;&#34;&#34;

        # self.scf = SyncCrazyflie(self.cf_uri)
        self.scf.open_link()
        # self.cf = self.scf.cf

        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Connected...&#39;)

        # Slow down
        self.set_speed_limit(self.world.speed_limit)

        # Set active marker IDs
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Setting active marker IDs: {self.marker_ids}&#39;)
        self.cf.param.set_value(&#39;activeMarker.front&#39;, self.marker_ids[0])
        self.cf.param.set_value(&#39;activeMarker.right&#39;, self.marker_ids[1])
        self.cf.param.set_value(&#39;activeMarker.back&#39;, self.marker_ids[2])
        self.cf.param.set_value(&#39;activeMarker.left&#39;, self.marker_ids[3])

        self.qtm = qfly.QtmWrapper(
            self.cf_body_name,
            lambda pose: self._set_pose(pose),
            qtm_ip=self.qtm_ip)

        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Connecting to QTM at {self.qtm.qtm_ip}...&#39;)

        self.setup()

        return self

    def __exit__(self, exc_type=None, exc_value=None, tb=None):
        &#34;&#34;&#34;
        Exits QualisysCrazyflie context
        &#34;&#34;&#34;
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Exiting...&#39;)
        if exc_type is not None:
            print(
                f&#39;[{self.cf_body_name}@{self.cf_uri}] Encountered exception on exit...&#39;)
            traceback.print_exception(exc_type, exc_value, tb)
        self.qtm.close()
        self.scf.close_link()

    def ascend(self, z_ceiling=1, step=12.0):
        &#34;&#34;&#34;
        Executes one step of a gentle ascension sequence
        directly upward from current position.

        Parameters
        ----------
        z_ceiling : float (optional) 
            Height to ascend to.
            (Unit: m)
        step : int (optional)
            Distance between target keyframes.
            (Unit: cm)
        &#34;&#34;&#34;
        init_pose = self.pose
        _z_cm = int(init_pose.z * 100)

        target = qfly.Pose(init_pose.x,
                           init_pose.y,
                           min(z_ceiling, float((_z_cm + step) / 100.0)))

        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Ascending from {_z_cm} cm to {z_ceiling}...&#39;)
        self.safe_position_setpoint(target)

    def descend(self, z_floor=0.0, step=12.0):
        &#34;&#34;&#34;
        Executes one step of a gentle descension sequence
        directly downward from current position.

        Parameters
        ----------
        z_floor : float (optional) 
            Height to descend to.
            (Unit: m)
        step : int (optional)
            Distance between target keyframes.
            (Unit: cm)
        &#34;&#34;&#34;
        init_pose = self.pose
        _z_cm = int(init_pose.z * 100)

        target = qfly.Pose(init_pose.x,
                           init_pose.y,
                           float((_z_cm - step) / 100.0))

        # Engage
        if target.z &lt; z_floor:
            self.cf.commander.send_stop_setpoint()
        else:
            print(
                f&#39;[{self.cf_body_name}@{self.cf_uri}] Descending from {_z_cm} cm to {z_floor} cm...&#39;)
            self.safe_position_setpoint(target)

    def is_safe(self, world=None):
        &#34;&#34;&#34;
        Performs safety checks, returns False if unsafe.

        Parameters
        ----------
        world : World (optional) 
            World object defining airspace rules.
            Defaults to QualisysCrazyflie object&#39;s own world.
        &#34;&#34;&#34;
        if world is None:
            world = self.world
        # Is the drone tracked properly?
        if self.qtm.tracking_loss &gt; world.tracking_tolerance:
            # Respond
            print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! SAFETY VIOLATION !!!
                TRACKING LOST FOR {str(self.world.tracking_tolerance)} FRAMES!&#39;&#39;&#39;)
            return False
        # Is the drone inside the safe volume?
        if not (
            # x direction
            world.origin.x - world.expanse &lt; self.pose.x &lt; world.origin.x + world.expanse
            # y direction
            and world.origin.y - world.expanse &lt; self.pose.y &lt; world.origin.y + world.expanse
            # z direction
                and 0 &lt; self.pose.z &lt; world.origin.z + (2 * world.expanse)):
            # Respond
            print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! SAFETY VIOLATION !!!
                DRONE OUTSIDE SAFE VOLUME AT ({str(self.pose)})!&#39;&#39;&#39;)
            return False
        else:
            return True

    def land_to_moving_target(self, target, z_offset=0.5, decrement=3, timestep=0.15):
        &#34;&#34;&#34;
        WARNING: UNDER DEVELOPMENT. DO NOT USE. DOES NOT SUPPORT SWARMS.
        Executes a gentle landing sequence aiming at a live target.

        Parameters
        ----------
        target : object
            An object that has a pose attribute
        z_offset : float (optional)
            Vertical offset between target and landing start pose.
            (Unit: m)
            (Default: 0.5 m)
        decrement : int (optional)
            Distance between target keyframes.
            (Unit: cm)
            (Default: 3 cm)
        timestep : float (optional
            Time between target keyframes.
            (Unit: s)
            (Default: 0.15 s)
        &#34;&#34;&#34;
        try:
            init_pose = qfly.Pose(target.pose.x,
                                  target.pose.y,
                                  target.pose.z + z_offset)
        except AttributeError:
            print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! ERROR !!!
                Landing target has no pose attribute! Landing in place instead!&#39;&#39;&#39;)
            self.land_in_place()
            return

        z_cm = int(init_pose.z * 100)

        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Landing to live target from {z_cm} cm...&#39;)

        # Linear interpolation between starting pose and target
        while z_cm &gt; target.pose.z * 100:
            target = qfly.Pose(target.pose.x, target.pose.y,
                               float(z_cm / 100.0))
            self.safe_position_setpoint(target)
            time.sleep(timestep)
            z_cm = z_cm - decrement
        self.cf.commander.send_stop_setpoint()

    def safe_position_setpoint(self, target, world=None):
        &#34;&#34;&#34;
        Sets a geofenced absolute position setpoint
        within safe airspace defined by world.

        Parameters
        ----------
        target : Pose
            Pose object bearting target coordinate and yaw.
            Yaw defaults to 0 if not supplied.
        world : World (optional) 
            World object defining airspace rules.
            Defaults to QualisysCrazyflie object&#39;s own world.
        &#34;&#34;&#34;
        # Sane defaults
        if world is None:
            world = self.world
        if target.yaw == None:
            target.yaw = 0
        # Keep inside safe airspace
        target.clamp(world)
        # Engage
        self.cf.commander.send_position_setpoint(
            target.x, target.y, target.z, target.yaw)

    def set_speed_limit(self, speed_limit):
        &#34;&#34;&#34;
        Sets speed in horizontal (xy) and vertical (z) dimensions.

        Parameters
        ----------
        speed_limit : float
            Speed limit.
            (Unit: m/s)
        &#34;&#34;&#34;
        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Speed limit: {speed_limit} m/s&#39;)
        self.cf.param.set_value(&#39;posCtlPid.xyVelMax&#39;, speed_limit)
        self.cf.param.set_value(&#39;posCtlPid.zVelMax&#39;, speed_limit)

    def setup(self):
        &#34;&#34;&#34;
        Executes engineering boilerplate to initialize drone.
        Assumes most drone parameters at factory defaults.
        If in doubt, inspect drone parameters
        using Bitcraze client and documentation.
        &#34;&#34;&#34;
        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Setting up drone...&#39;)

        # Choose estimator
        self.cf.param.set_value(&#39;stabilizer.estimator&#39;, &#39;2&#39;)

        # Black magic
        self.cf.param.set_value(&#39;locSrv.extQuatStdDev&#39;, 0.06)

        # Reset estimator
        self.cf.param.set_value(&#39;kalman.resetEstimation&#39;, &#39;1&#39;)
        time.sleep(0.1)
        self.cf.param.set_value(&#39;kalman.resetEstimation&#39;, &#39;0&#39;)

        # Stabilize
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Stabilizing...&#39;)

        log_config = LogConfig(name=&#39;Kalman Variance&#39;, period_in_ms=500)
        log_config.add_variable(&#39;kalman.varPX&#39;, &#39;float&#39;)
        log_config.add_variable(&#39;kalman.varPY&#39;, &#39;float&#39;)
        log_config.add_variable(&#39;kalman.varPZ&#39;, &#39;float&#39;)

        var_y_history = [1000] * 10
        var_x_history = [1000] * 10
        var_z_history = [1000] * 10

        threshold = 0.001

        with SyncLogger(self.scf, log_config) as logger:
            for log_entry in logger:
                data = log_entry[1]

                var_x_history.append(data[&#39;kalman.varPX&#39;])
                var_x_history.pop(0)
                var_y_history.append(data[&#39;kalman.varPY&#39;])
                var_y_history.pop(0)
                var_z_history.append(data[&#39;kalman.varPZ&#39;])
                var_z_history.pop(0)

                min_x = min(var_x_history)
                max_x = max(var_x_history)
                min_y = min(var_y_history)
                max_y = max(var_y_history)
                min_z = min(var_z_history)
                max_z = max(var_z_history)

                print(f&#39;[{self.cf_body_name}@{self.cf_uri}] &#39; +
                      &#34;Kalman variance | X: {:8.4f}  Y: {:8.4f}  Z: {:8.4f}&#34;.format(
                          max_x - min_x, max_y - min_y, max_z - min_z))

                if (max_x - min_x) &lt; threshold and (
                        max_y - min_y) &lt; threshold and (
                        max_z - min_z) &lt; threshold:
                    break

    def _set_pose(self, pose):
        &#34;&#34;&#34;
        Sets internal Pose object and stream to drone

        Parameters
        ----------
        pose : Pose
            Pose object containing coordinates
        &#34;&#34;&#34;
        self.pose = pose
        # Send to Crazyflie
        if self.cf is not None:
            self.cf.extpos.send_extpos(pose.x, pose.y, pose.z)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="qfly.crazyflie.QualisysCrazyflie"><code class="flex name class">
<span>class <span class="ident">QualisysCrazyflie</span></span>
<span>(</span><span>cf_body_name, cf_uri, world, marker_ids=[1, 2, 3, 4], qtm_ip='127.0.0.1')</span>
</code></dt>
<dd>
<div class="desc"><p>Wrapper to track and fly a Bitcraze Crazyflie drone
with Qualisys motion capture systems.</p>
<p>Constructs a QualisysCrazyflie object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>cf_body_name</code></strong> :&ensp;<code>str</code></dt>
<dd>Name of Crazyflie's rigid body in QTM.</dd>
<dt><strong><code>cf_uri</code></strong> :&ensp;<code>str</code></dt>
<dd>Crazyflie radio address.</dd>
<dt><strong><code>world</code></strong> :&ensp;<code>World</code></dt>
<dd>World object defining airspace rules.</dd>
<dt><strong><code>marker_ids</code></strong> :&ensp;<code>[int] (optional)</code></dt>
<dd>ID numbers to be assigned to active markers
in order of front, right, back, left.</dd>
<dt><strong><code>qtm_ip</code></strong> :&ensp;<code>str (optional)</code></dt>
<dd>IP address of QTM host.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class QualisysCrazyflie(Thread):
    &#34;&#34;&#34;
    Wrapper to track and fly a Bitcraze Crazyflie drone
    with Qualisys motion capture systems.
    &#34;&#34;&#34;

    def __init__(self,
                 cf_body_name,
                 cf_uri,
                 world,
                 marker_ids=[1, 2, 3, 4],
                 qtm_ip=&#34;127.0.0.1&#34;):
        &#34;&#34;&#34;
        Constructs a QualisysCrazyflie object.

        Parameters
        ----------
        cf_body_name : str
            Name of Crazyflie&#39;s rigid body in QTM.
        cf_uri : str
            Crazyflie radio address.
        world : World
            World object defining airspace rules.
        marker_ids : [int] (optional)
            ID numbers to be assigned to active markers
            in order of front, right, back, left.
        qtm_ip : str (optional)
            IP address of QTM host.
        &#34;&#34;&#34;

        print(f&#39;[{cf_body_name}@{cf_uri}] Initializing...&#39;)

        cflib.crtp.init_drivers()

        self.cf_body_name = cf_body_name
        self.cf_uri = cf_uri
        self.world = world
        self.marker_ids = marker_ids

        self.pose = None
        self.qtm = None
        self.qtm_ip = qtm_ip

        self.cf = Crazyflie(ro_cache=None, rw_cache=None)
        self.scf = SyncCrazyflie(self.cf_uri, cf=self.cf)

        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Connecting...&#39;)

    def __enter__(self):
        &#34;&#34;&#34;
        Enters QualisysCrazyflie context
        &#34;&#34;&#34;

        # self.scf = SyncCrazyflie(self.cf_uri)
        self.scf.open_link()
        # self.cf = self.scf.cf

        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Connected...&#39;)

        # Slow down
        self.set_speed_limit(self.world.speed_limit)

        # Set active marker IDs
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Setting active marker IDs: {self.marker_ids}&#39;)
        self.cf.param.set_value(&#39;activeMarker.front&#39;, self.marker_ids[0])
        self.cf.param.set_value(&#39;activeMarker.right&#39;, self.marker_ids[1])
        self.cf.param.set_value(&#39;activeMarker.back&#39;, self.marker_ids[2])
        self.cf.param.set_value(&#39;activeMarker.left&#39;, self.marker_ids[3])

        self.qtm = qfly.QtmWrapper(
            self.cf_body_name,
            lambda pose: self._set_pose(pose),
            qtm_ip=self.qtm_ip)

        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Connecting to QTM at {self.qtm.qtm_ip}...&#39;)

        self.setup()

        return self

    def __exit__(self, exc_type=None, exc_value=None, tb=None):
        &#34;&#34;&#34;
        Exits QualisysCrazyflie context
        &#34;&#34;&#34;
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Exiting...&#39;)
        if exc_type is not None:
            print(
                f&#39;[{self.cf_body_name}@{self.cf_uri}] Encountered exception on exit...&#39;)
            traceback.print_exception(exc_type, exc_value, tb)
        self.qtm.close()
        self.scf.close_link()

    def ascend(self, z_ceiling=1, step=12.0):
        &#34;&#34;&#34;
        Executes one step of a gentle ascension sequence
        directly upward from current position.

        Parameters
        ----------
        z_ceiling : float (optional) 
            Height to ascend to.
            (Unit: m)
        step : int (optional)
            Distance between target keyframes.
            (Unit: cm)
        &#34;&#34;&#34;
        init_pose = self.pose
        _z_cm = int(init_pose.z * 100)

        target = qfly.Pose(init_pose.x,
                           init_pose.y,
                           min(z_ceiling, float((_z_cm + step) / 100.0)))

        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Ascending from {_z_cm} cm to {z_ceiling}...&#39;)
        self.safe_position_setpoint(target)

    def descend(self, z_floor=0.0, step=12.0):
        &#34;&#34;&#34;
        Executes one step of a gentle descension sequence
        directly downward from current position.

        Parameters
        ----------
        z_floor : float (optional) 
            Height to descend to.
            (Unit: m)
        step : int (optional)
            Distance between target keyframes.
            (Unit: cm)
        &#34;&#34;&#34;
        init_pose = self.pose
        _z_cm = int(init_pose.z * 100)

        target = qfly.Pose(init_pose.x,
                           init_pose.y,
                           float((_z_cm - step) / 100.0))

        # Engage
        if target.z &lt; z_floor:
            self.cf.commander.send_stop_setpoint()
        else:
            print(
                f&#39;[{self.cf_body_name}@{self.cf_uri}] Descending from {_z_cm} cm to {z_floor} cm...&#39;)
            self.safe_position_setpoint(target)

    def is_safe(self, world=None):
        &#34;&#34;&#34;
        Performs safety checks, returns False if unsafe.

        Parameters
        ----------
        world : World (optional) 
            World object defining airspace rules.
            Defaults to QualisysCrazyflie object&#39;s own world.
        &#34;&#34;&#34;
        if world is None:
            world = self.world
        # Is the drone tracked properly?
        if self.qtm.tracking_loss &gt; world.tracking_tolerance:
            # Respond
            print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! SAFETY VIOLATION !!!
                TRACKING LOST FOR {str(self.world.tracking_tolerance)} FRAMES!&#39;&#39;&#39;)
            return False
        # Is the drone inside the safe volume?
        if not (
            # x direction
            world.origin.x - world.expanse &lt; self.pose.x &lt; world.origin.x + world.expanse
            # y direction
            and world.origin.y - world.expanse &lt; self.pose.y &lt; world.origin.y + world.expanse
            # z direction
                and 0 &lt; self.pose.z &lt; world.origin.z + (2 * world.expanse)):
            # Respond
            print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! SAFETY VIOLATION !!!
                DRONE OUTSIDE SAFE VOLUME AT ({str(self.pose)})!&#39;&#39;&#39;)
            return False
        else:
            return True

    def land_to_moving_target(self, target, z_offset=0.5, decrement=3, timestep=0.15):
        &#34;&#34;&#34;
        WARNING: UNDER DEVELOPMENT. DO NOT USE. DOES NOT SUPPORT SWARMS.
        Executes a gentle landing sequence aiming at a live target.

        Parameters
        ----------
        target : object
            An object that has a pose attribute
        z_offset : float (optional)
            Vertical offset between target and landing start pose.
            (Unit: m)
            (Default: 0.5 m)
        decrement : int (optional)
            Distance between target keyframes.
            (Unit: cm)
            (Default: 3 cm)
        timestep : float (optional
            Time between target keyframes.
            (Unit: s)
            (Default: 0.15 s)
        &#34;&#34;&#34;
        try:
            init_pose = qfly.Pose(target.pose.x,
                                  target.pose.y,
                                  target.pose.z + z_offset)
        except AttributeError:
            print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! ERROR !!!
                Landing target has no pose attribute! Landing in place instead!&#39;&#39;&#39;)
            self.land_in_place()
            return

        z_cm = int(init_pose.z * 100)

        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Landing to live target from {z_cm} cm...&#39;)

        # Linear interpolation between starting pose and target
        while z_cm &gt; target.pose.z * 100:
            target = qfly.Pose(target.pose.x, target.pose.y,
                               float(z_cm / 100.0))
            self.safe_position_setpoint(target)
            time.sleep(timestep)
            z_cm = z_cm - decrement
        self.cf.commander.send_stop_setpoint()

    def safe_position_setpoint(self, target, world=None):
        &#34;&#34;&#34;
        Sets a geofenced absolute position setpoint
        within safe airspace defined by world.

        Parameters
        ----------
        target : Pose
            Pose object bearting target coordinate and yaw.
            Yaw defaults to 0 if not supplied.
        world : World (optional) 
            World object defining airspace rules.
            Defaults to QualisysCrazyflie object&#39;s own world.
        &#34;&#34;&#34;
        # Sane defaults
        if world is None:
            world = self.world
        if target.yaw == None:
            target.yaw = 0
        # Keep inside safe airspace
        target.clamp(world)
        # Engage
        self.cf.commander.send_position_setpoint(
            target.x, target.y, target.z, target.yaw)

    def set_speed_limit(self, speed_limit):
        &#34;&#34;&#34;
        Sets speed in horizontal (xy) and vertical (z) dimensions.

        Parameters
        ----------
        speed_limit : float
            Speed limit.
            (Unit: m/s)
        &#34;&#34;&#34;
        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Speed limit: {speed_limit} m/s&#39;)
        self.cf.param.set_value(&#39;posCtlPid.xyVelMax&#39;, speed_limit)
        self.cf.param.set_value(&#39;posCtlPid.zVelMax&#39;, speed_limit)

    def setup(self):
        &#34;&#34;&#34;
        Executes engineering boilerplate to initialize drone.
        Assumes most drone parameters at factory defaults.
        If in doubt, inspect drone parameters
        using Bitcraze client and documentation.
        &#34;&#34;&#34;
        print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Setting up drone...&#39;)

        # Choose estimator
        self.cf.param.set_value(&#39;stabilizer.estimator&#39;, &#39;2&#39;)

        # Black magic
        self.cf.param.set_value(&#39;locSrv.extQuatStdDev&#39;, 0.06)

        # Reset estimator
        self.cf.param.set_value(&#39;kalman.resetEstimation&#39;, &#39;1&#39;)
        time.sleep(0.1)
        self.cf.param.set_value(&#39;kalman.resetEstimation&#39;, &#39;0&#39;)

        # Stabilize
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Stabilizing...&#39;)

        log_config = LogConfig(name=&#39;Kalman Variance&#39;, period_in_ms=500)
        log_config.add_variable(&#39;kalman.varPX&#39;, &#39;float&#39;)
        log_config.add_variable(&#39;kalman.varPY&#39;, &#39;float&#39;)
        log_config.add_variable(&#39;kalman.varPZ&#39;, &#39;float&#39;)

        var_y_history = [1000] * 10
        var_x_history = [1000] * 10
        var_z_history = [1000] * 10

        threshold = 0.001

        with SyncLogger(self.scf, log_config) as logger:
            for log_entry in logger:
                data = log_entry[1]

                var_x_history.append(data[&#39;kalman.varPX&#39;])
                var_x_history.pop(0)
                var_y_history.append(data[&#39;kalman.varPY&#39;])
                var_y_history.pop(0)
                var_z_history.append(data[&#39;kalman.varPZ&#39;])
                var_z_history.pop(0)

                min_x = min(var_x_history)
                max_x = max(var_x_history)
                min_y = min(var_y_history)
                max_y = max(var_y_history)
                min_z = min(var_z_history)
                max_z = max(var_z_history)

                print(f&#39;[{self.cf_body_name}@{self.cf_uri}] &#39; +
                      &#34;Kalman variance | X: {:8.4f}  Y: {:8.4f}  Z: {:8.4f}&#34;.format(
                          max_x - min_x, max_y - min_y, max_z - min_z))

                if (max_x - min_x) &lt; threshold and (
                        max_y - min_y) &lt; threshold and (
                        max_z - min_z) &lt; threshold:
                    break

    def _set_pose(self, pose):
        &#34;&#34;&#34;
        Sets internal Pose object and stream to drone

        Parameters
        ----------
        pose : Pose
            Pose object containing coordinates
        &#34;&#34;&#34;
        self.pose = pose
        # Send to Crazyflie
        if self.cf is not None:
            self.cf.extpos.send_extpos(pose.x, pose.y, pose.z)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>threading.Thread</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="qfly.crazyflie.QualisysCrazyflie.ascend"><code class="name flex">
<span>def <span class="ident">ascend</span></span>(<span>self, z_ceiling=1, step=12.0)</span>
</code></dt>
<dd>
<div class="desc"><p>Executes one step of a gentle ascension sequence
directly upward from current position.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>z_ceiling</code></strong> :&ensp;<code>float (optional) </code></dt>
<dd>Height to ascend to.
(Unit: m)</dd>
<dt><strong><code>step</code></strong> :&ensp;<code>int (optional)</code></dt>
<dd>Distance between target keyframes.
(Unit: cm)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def ascend(self, z_ceiling=1, step=12.0):
    &#34;&#34;&#34;
    Executes one step of a gentle ascension sequence
    directly upward from current position.

    Parameters
    ----------
    z_ceiling : float (optional) 
        Height to ascend to.
        (Unit: m)
    step : int (optional)
        Distance between target keyframes.
        (Unit: cm)
    &#34;&#34;&#34;
    init_pose = self.pose
    _z_cm = int(init_pose.z * 100)

    target = qfly.Pose(init_pose.x,
                       init_pose.y,
                       min(z_ceiling, float((_z_cm + step) / 100.0)))

    print(
        f&#39;[{self.cf_body_name}@{self.cf_uri}] Ascending from {_z_cm} cm to {z_ceiling}...&#39;)
    self.safe_position_setpoint(target)</code></pre>
</details>
</dd>
<dt id="qfly.crazyflie.QualisysCrazyflie.descend"><code class="name flex">
<span>def <span class="ident">descend</span></span>(<span>self, z_floor=0.0, step=12.0)</span>
</code></dt>
<dd>
<div class="desc"><p>Executes one step of a gentle descension sequence
directly downward from current position.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>z_floor</code></strong> :&ensp;<code>float (optional) </code></dt>
<dd>Height to descend to.
(Unit: m)</dd>
<dt><strong><code>step</code></strong> :&ensp;<code>int (optional)</code></dt>
<dd>Distance between target keyframes.
(Unit: cm)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def descend(self, z_floor=0.0, step=12.0):
    &#34;&#34;&#34;
    Executes one step of a gentle descension sequence
    directly downward from current position.

    Parameters
    ----------
    z_floor : float (optional) 
        Height to descend to.
        (Unit: m)
    step : int (optional)
        Distance between target keyframes.
        (Unit: cm)
    &#34;&#34;&#34;
    init_pose = self.pose
    _z_cm = int(init_pose.z * 100)

    target = qfly.Pose(init_pose.x,
                       init_pose.y,
                       float((_z_cm - step) / 100.0))

    # Engage
    if target.z &lt; z_floor:
        self.cf.commander.send_stop_setpoint()
    else:
        print(
            f&#39;[{self.cf_body_name}@{self.cf_uri}] Descending from {_z_cm} cm to {z_floor} cm...&#39;)
        self.safe_position_setpoint(target)</code></pre>
</details>
</dd>
<dt id="qfly.crazyflie.QualisysCrazyflie.is_safe"><code class="name flex">
<span>def <span class="ident">is_safe</span></span>(<span>self, world=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Performs safety checks, returns False if unsafe.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>world</code></strong> :&ensp;<code>World (optional) </code></dt>
<dd>World object defining airspace rules.
Defaults to QualisysCrazyflie object's own world.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def is_safe(self, world=None):
    &#34;&#34;&#34;
    Performs safety checks, returns False if unsafe.

    Parameters
    ----------
    world : World (optional) 
        World object defining airspace rules.
        Defaults to QualisysCrazyflie object&#39;s own world.
    &#34;&#34;&#34;
    if world is None:
        world = self.world
    # Is the drone tracked properly?
    if self.qtm.tracking_loss &gt; world.tracking_tolerance:
        # Respond
        print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! SAFETY VIOLATION !!!
            TRACKING LOST FOR {str(self.world.tracking_tolerance)} FRAMES!&#39;&#39;&#39;)
        return False
    # Is the drone inside the safe volume?
    if not (
        # x direction
        world.origin.x - world.expanse &lt; self.pose.x &lt; world.origin.x + world.expanse
        # y direction
        and world.origin.y - world.expanse &lt; self.pose.y &lt; world.origin.y + world.expanse
        # z direction
            and 0 &lt; self.pose.z &lt; world.origin.z + (2 * world.expanse)):
        # Respond
        print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! SAFETY VIOLATION !!!
            DRONE OUTSIDE SAFE VOLUME AT ({str(self.pose)})!&#39;&#39;&#39;)
        return False
    else:
        return True</code></pre>
</details>
</dd>
<dt id="qfly.crazyflie.QualisysCrazyflie.land_to_moving_target"><code class="name flex">
<span>def <span class="ident">land_to_moving_target</span></span>(<span>self, target, z_offset=0.5, decrement=3, timestep=0.15)</span>
</code></dt>
<dd>
<div class="desc"><p>WARNING: UNDER DEVELOPMENT. DO NOT USE. DOES NOT SUPPORT SWARMS.
Executes a gentle landing sequence aiming at a live target.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>target</code></strong> :&ensp;<code>object</code></dt>
<dd>An object that has a pose attribute</dd>
<dt><strong><code>z_offset</code></strong> :&ensp;<code>float (optional)</code></dt>
<dd>Vertical offset between target and landing start pose.
(Unit: m)
(Default: 0.5 m)</dd>
<dt><strong><code>decrement</code></strong> :&ensp;<code>int (optional)</code></dt>
<dd>Distance between target keyframes.
(Unit: cm)
(Default: 3 cm)</dd>
<dt><strong><code>timestep</code></strong> :&ensp;<code>float (optional</code></dt>
<dd>Time between target keyframes.
(Unit: s)
(Default: 0.15 s)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def land_to_moving_target(self, target, z_offset=0.5, decrement=3, timestep=0.15):
    &#34;&#34;&#34;
    WARNING: UNDER DEVELOPMENT. DO NOT USE. DOES NOT SUPPORT SWARMS.
    Executes a gentle landing sequence aiming at a live target.

    Parameters
    ----------
    target : object
        An object that has a pose attribute
    z_offset : float (optional)
        Vertical offset between target and landing start pose.
        (Unit: m)
        (Default: 0.5 m)
    decrement : int (optional)
        Distance between target keyframes.
        (Unit: cm)
        (Default: 3 cm)
    timestep : float (optional
        Time between target keyframes.
        (Unit: s)
        (Default: 0.15 s)
    &#34;&#34;&#34;
    try:
        init_pose = qfly.Pose(target.pose.x,
                              target.pose.y,
                              target.pose.z + z_offset)
    except AttributeError:
        print(f&#39;&#39;&#39;[{self.cf_body_name}@{self.cf_uri}] !!! ERROR !!!
            Landing target has no pose attribute! Landing in place instead!&#39;&#39;&#39;)
        self.land_in_place()
        return

    z_cm = int(init_pose.z * 100)

    print(
        f&#39;[{self.cf_body_name}@{self.cf_uri}] Landing to live target from {z_cm} cm...&#39;)

    # Linear interpolation between starting pose and target
    while z_cm &gt; target.pose.z * 100:
        target = qfly.Pose(target.pose.x, target.pose.y,
                           float(z_cm / 100.0))
        self.safe_position_setpoint(target)
        time.sleep(timestep)
        z_cm = z_cm - decrement
    self.cf.commander.send_stop_setpoint()</code></pre>
</details>
</dd>
<dt id="qfly.crazyflie.QualisysCrazyflie.safe_position_setpoint"><code class="name flex">
<span>def <span class="ident">safe_position_setpoint</span></span>(<span>self, target, world=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets a geofenced absolute position setpoint
within safe airspace defined by world.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>target</code></strong> :&ensp;<code>Pose</code></dt>
<dd>Pose object bearting target coordinate and yaw.
Yaw defaults to 0 if not supplied.</dd>
<dt><strong><code>world</code></strong> :&ensp;<code>World (optional) </code></dt>
<dd>World object defining airspace rules.
Defaults to QualisysCrazyflie object's own world.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def safe_position_setpoint(self, target, world=None):
    &#34;&#34;&#34;
    Sets a geofenced absolute position setpoint
    within safe airspace defined by world.

    Parameters
    ----------
    target : Pose
        Pose object bearting target coordinate and yaw.
        Yaw defaults to 0 if not supplied.
    world : World (optional) 
        World object defining airspace rules.
        Defaults to QualisysCrazyflie object&#39;s own world.
    &#34;&#34;&#34;
    # Sane defaults
    if world is None:
        world = self.world
    if target.yaw == None:
        target.yaw = 0
    # Keep inside safe airspace
    target.clamp(world)
    # Engage
    self.cf.commander.send_position_setpoint(
        target.x, target.y, target.z, target.yaw)</code></pre>
</details>
</dd>
<dt id="qfly.crazyflie.QualisysCrazyflie.set_speed_limit"><code class="name flex">
<span>def <span class="ident">set_speed_limit</span></span>(<span>self, speed_limit)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets speed in horizontal (xy) and vertical (z) dimensions.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>speed_limit</code></strong> :&ensp;<code>float</code></dt>
<dd>Speed limit.
(Unit: m/s)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_speed_limit(self, speed_limit):
    &#34;&#34;&#34;
    Sets speed in horizontal (xy) and vertical (z) dimensions.

    Parameters
    ----------
    speed_limit : float
        Speed limit.
        (Unit: m/s)
    &#34;&#34;&#34;
    print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Speed limit: {speed_limit} m/s&#39;)
    self.cf.param.set_value(&#39;posCtlPid.xyVelMax&#39;, speed_limit)
    self.cf.param.set_value(&#39;posCtlPid.zVelMax&#39;, speed_limit)</code></pre>
</details>
</dd>
<dt id="qfly.crazyflie.QualisysCrazyflie.setup"><code class="name flex">
<span>def <span class="ident">setup</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Executes engineering boilerplate to initialize drone.
Assumes most drone parameters at factory defaults.
If in doubt, inspect drone parameters
using Bitcraze client and documentation.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setup(self):
    &#34;&#34;&#34;
    Executes engineering boilerplate to initialize drone.
    Assumes most drone parameters at factory defaults.
    If in doubt, inspect drone parameters
    using Bitcraze client and documentation.
    &#34;&#34;&#34;
    print(f&#39;[{self.cf_body_name}@{self.cf_uri}] Setting up drone...&#39;)

    # Choose estimator
    self.cf.param.set_value(&#39;stabilizer.estimator&#39;, &#39;2&#39;)

    # Black magic
    self.cf.param.set_value(&#39;locSrv.extQuatStdDev&#39;, 0.06)

    # Reset estimator
    self.cf.param.set_value(&#39;kalman.resetEstimation&#39;, &#39;1&#39;)
    time.sleep(0.1)
    self.cf.param.set_value(&#39;kalman.resetEstimation&#39;, &#39;0&#39;)

    # Stabilize
    print(
        f&#39;[{self.cf_body_name}@{self.cf_uri}] Stabilizing...&#39;)

    log_config = LogConfig(name=&#39;Kalman Variance&#39;, period_in_ms=500)
    log_config.add_variable(&#39;kalman.varPX&#39;, &#39;float&#39;)
    log_config.add_variable(&#39;kalman.varPY&#39;, &#39;float&#39;)
    log_config.add_variable(&#39;kalman.varPZ&#39;, &#39;float&#39;)

    var_y_history = [1000] * 10
    var_x_history = [1000] * 10
    var_z_history = [1000] * 10

    threshold = 0.001

    with SyncLogger(self.scf, log_config) as logger:
        for log_entry in logger:
            data = log_entry[1]

            var_x_history.append(data[&#39;kalman.varPX&#39;])
            var_x_history.pop(0)
            var_y_history.append(data[&#39;kalman.varPY&#39;])
            var_y_history.pop(0)
            var_z_history.append(data[&#39;kalman.varPZ&#39;])
            var_z_history.pop(0)

            min_x = min(var_x_history)
            max_x = max(var_x_history)
            min_y = min(var_y_history)
            max_y = max(var_y_history)
            min_z = min(var_z_history)
            max_z = max(var_z_history)

            print(f&#39;[{self.cf_body_name}@{self.cf_uri}] &#39; +
                  &#34;Kalman variance | X: {:8.4f}  Y: {:8.4f}  Z: {:8.4f}&#34;.format(
                      max_x - min_x, max_y - min_y, max_z - min_z))

            if (max_x - min_x) &lt; threshold and (
                    max_y - min_y) &lt; threshold and (
                    max_z - min_z) &lt; threshold:
                break</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="qfly" href="index.html">qfly</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="qfly.crazyflie.QualisysCrazyflie" href="#qfly.crazyflie.QualisysCrazyflie">QualisysCrazyflie</a></code></h4>
<ul class="">
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.ascend" href="#qfly.crazyflie.QualisysCrazyflie.ascend">ascend</a></code></li>
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.descend" href="#qfly.crazyflie.QualisysCrazyflie.descend">descend</a></code></li>
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.is_safe" href="#qfly.crazyflie.QualisysCrazyflie.is_safe">is_safe</a></code></li>
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.land_to_moving_target" href="#qfly.crazyflie.QualisysCrazyflie.land_to_moving_target">land_to_moving_target</a></code></li>
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.safe_position_setpoint" href="#qfly.crazyflie.QualisysCrazyflie.safe_position_setpoint">safe_position_setpoint</a></code></li>
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.set_speed_limit" href="#qfly.crazyflie.QualisysCrazyflie.set_speed_limit">set_speed_limit</a></code></li>
<li><code><a title="qfly.crazyflie.QualisysCrazyflie.setup" href="#qfly.crazyflie.QualisysCrazyflie.setup">setup</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>